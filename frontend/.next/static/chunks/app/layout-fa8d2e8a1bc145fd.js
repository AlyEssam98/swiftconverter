(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{2803:(e,t,r)=>{Promise.resolve().then(r.bind(r,3429)),Promise.resolve().then(r.t.bind(r,7869,23)),Promise.resolve().then(r.t.bind(r,5214,23)),Promise.resolve().then(r.bind(r,7776))},3429:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>u,a:()=>c});var s=r(7437),o=r(2265),a=r(6264),n=r(6463);let i=(0,o.createContext)(void 0),l="session_token";function u(e){let{children:t}=e,[r,u]=(0,o.useState)(null),[c,d]=(0,o.useState)(!0),h=(0,n.useRouter)(),v=(0,o.useCallback)(()=>{try{sessionStorage.removeItem(l),localStorage.removeItem("token")}catch(e){}u(null)},[]),f=(0,o.useCallback)(async()=>{try{let e=await a.default.get("/api/v1/profile");u(t=>t?{...t,...e.data}:{token:"",...e.data})}catch(e){console.error("Failed to fetch profile",e)}},[]),m=(0,o.useCallback)(async()=>{await f()},[f]);(0,o.useEffect)(()=>{(async()=>{let e=sessionStorage.getItem(l);if(e){u({token:e});try{await f()}catch(e){console.error("Failed to fetch profile during init",e)}}d(!1)})()},[]);let p=async()=>{try{await a.default.post("/api/v1/auth/logout")}catch(e){}v(),h.push("/auth/login")};return(0,s.jsx)(i.Provider,{value:{user:r,login:e=>{sessionStorage.setItem(l,e),u({token:e}),d(!1)},logout:p,isLoading:c,refreshUser:m},children:t})}function c(){let e=(0,o.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6264:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var s,o=r(8472),a=r(357);let n="session_token",i=o.Z.create({baseURL:null!==(s=a.env.NEXT_PUBLIC_API_URL)&&void 0!==s?s:"http://localhost:8081",headers:{"Content-Type":"application/json"}});i.interceptors.request.use(e=>{let t=sessionStorage.getItem(n);return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),i.interceptors.response.use(e=>e,e=>{var t,r;let s=null===(t=e.response)||void 0===t?void 0:t.status,o=(null===(r=e.config)||void 0===r?void 0:r.url)||"",a=o.includes("/profile")||o.includes("/dashboard")||o.includes("/credits/balance")||o.includes("/conversions");if(401===s&&a){try{sessionStorage.removeItem(n),localStorage.removeItem("token")}catch(e){}return window.location.href="/auth/login",Promise.resolve()}return Promise.reject(e)});let l=i},6463:(e,t,r)=>{"use strict";var s=r(1169);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},5214:()=>{},7869:e=>{e.exports={style:{fontFamily:"'Inter', 'Inter Fallback'",fontStyle:"normal"},className:"__className_f367f3",variable:"__variable_f367f3"}}},e=>{var t=t=>e(e.s=t);e.O(0,[965,472,776,130,215,744],()=>t(2803)),_N_E=e.O()}]);